<HTML>
<HEAD>
<TITLE>40th IMO shortlist 1999/N4 solution</TITLE>
</HEAD>
<BODY TEXT="#000000" LINK="#0000ff" VLINK="#800080" ALINK="#ff0000">
<h3>40th IMO 1999 shortlist</h3>
<IMG src="../../line1.gif" ALT="------"><br>&nbsp;<br>&nbsp;<br>
<b>Problem N4</b><br>
<p>
Show that there are infinitely many primes p such that 1/p has its shortest period divisible by 3: 1/p = 0.a<sub>1</sub>a<sub>2</sub> ... a<sub>3k</sub>a<sub>1</sub>a<sub>2</sub>... . Amongst such primes find the largest possible value for a<sub>i</sub> + a<sub>i+k</sub> + a<sub>i+2k</sub>. For example, 1/7 = 0.142857... So the possible values for p = 7 are 1+2+5 = 8 and 4+8+7 = 19. 
<p>
&nbsp;<p>
<b>Solution</b><br>
<p>
The shortest period is the smallest d such that p divides 10<sup>d</sup> - 1. [We know, for example, that p divides 10<sup>p-1</sup> - 1, so such d exists, but that line of thought does not lead anywhere.]
<p>
Let p be a prime and let N<sub>p</sub> = 10<sup>2p</sup> + 10<sup>p</sup> + 1. Obviously N<sub>p</sub> = 3 mod 9, so N<sub>p</sub> is divisible by 3 but not 9. So take q to be a prime dividing N<sub>p</sub>/3. We have just established that q is not 3. Now 10<sup>3p</sup> - 1 = N<sub>p</sub>(10<sup>p</sup> - 1), so q divides 10<sup>3p</sup> - 1. Hence the shortest period d for q must divide 3p. So it must be 1, 3, p or 3p.
<p>
It cannot be 1 for then q would divide 10 - 1 = 9 and we have shown that q is not 3. It cannot be p, for then N<sub>p</sub> = 1 + 1 + 1 = 3 mod q, whereas we are assuming that q divides N<sub>p</sub>. If it is 3, then q divides 10<sup>3</sup> - 1 = 3<sup>3</sup>37 and so q = 37. Now we claim that we can always choose q to be a prime other than 37. If this were not true then we would have N<sub>p</sub> = 3.37<sup>k</sup>. But then N<sub>p</sub> = 3 mod 4, whereas N<sub>p</sub> = 1 mod 4. So d must be 3p. Thus by letting p run through the primes, we get a sequence of primes q with shortest period 3p. Each prime q must be distinct, since each has a distinct shortest period. So we get infinitely many primes q with shortest period a multiple of 3.
<p>
Suppose 1/q = 0.a<sub>1</sub>a<sub>2</sub>a<sub>3</sub> ... with shortest period 3p. Then b<sub>j</sub> = 0.a<sub>j</sub>a<sub>j+1</sub>a<sub>j+2</sub> ... is the fractional part of 10<sup>j-1</sup>/q. Obviously a<sub>j</sub> &lt; 10 b<sub>j</sub>, so a<sub>j</sub> + a<sub>j+p</sub> + a<sub>j+2p</sub> &lt; 10(b<sub>j</sub> + b<sub>j+p</sub> + b<sub>j+2p</sub>) = (1/q) (10<sup>j</sup> + 10<sup>j+p</sup> + 10<sup>j+2p</sup> = 10<sup>j</sup>N<sub>p</sub>/q. But N<sub>p</sub>/q is an integer, so 10(b<sub>j</sub> + b<sub>j+p</sub> + b<sub>j+2p</sub>) is a multiple of 10. Each b<sub>i</sub> &lt; 1, so 10(b<sub>j</sub> + b<sub>j+p</sub> + b<sub>j+2p</sub>) &le; 20 and hence a<sub>j</sub> + a<sub>j+p</sub> + a<sub>j+2p</sub> &le; 19. But 19 can be achieved, as illustrated by the case 1/7.
<p>
&nbsp;<p>
<IMG SRC="../../line2.gif" WIDTH=100% HEIGHT="2"><br>
<p>
&nbsp;<p>
<a href="../sh99.html">40th IMO shortlist 1999</a><br>
<p>&copy; John Scholes<br>
jscholes@kalva.demon.co.uk<br>
10 Oct 2002
</BODY>

</HTML>

